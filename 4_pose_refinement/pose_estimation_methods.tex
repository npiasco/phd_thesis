\section{Pose refinement}

Innovative contribution from \citet{Torii2011} refine the query location with a linear interpolation in the feature space domain of the closest database images. The database is arranged with a graph representation, where images represent the nodes and the edges encode spatial relation, i.e. images that are close to each other (according to their GPS-tag) are connected. Firstly, a set of putative candidates are retrieved with a conventional quantization method, then the discrete feature space of the candidate is extended into a continuous space by linear interpolation according to their position in the graph. The exact position of the query is then guessed according to linear combination of GPS information of the database images. Although promising, this method relies on complete panorama images, limiting its range of applications. Similar method have been used in~\citep{Sattler2019} to prove that Posenet-like methods can only average learned pose from data instead of reasoning on the image geometry to compute real 6-\ac{dof} pose.


Between methods based on prior information and F2P methods, works from \citet{Arth2009} present a system that recover the pose of a smart-phone camera by confronting an image to a subset of 3D points that should be visible in the query according to a prior pose information.

\citep{Li2019} -> relative pose computation with CNN + \citep{Rocco2018}

Similar to work described in~\citep{Rubio2015,Sattler2017}, \citet{Song2016} present a typical cascade scheme to estimate the 6 \ac{dof} pose of a given image. The authors perform a first step indirect method to retrieve a set of potential similar candidates, and then refine the pose with relative pose computation algorithms + de details. 
\label{para:pose_compute}
Numerous techniques can be applied to recover the exact 6 \ac{dof} of a given query. If the reference data are geo-localized images displaying primarily planar surfaces, homography retrieval can be employed~\citep{Forstner2016}. The relative pose from the query and the reference images can also be regressed with multi-view algorithms \citep{Hartley2003}. Nist\'er's 5-points algorithm \citep{Nister2004} or the 8-points algorithm by \citet{Hartley1997} are used in many \ac{vbl} scenario \citep{Qu2016}. Recently \ac{cnn} have been used to warp an affine or thin-plate-spline transformation between two images~\citep{Rocco2017}, or to estimate the relative transformation between two images~\citep{Melekhova}. Although not precise as classical methods, the presented network is able to deal with drastically different images in appearance. If numerous reference images are available, more complete methods are used involving trifocals geometry \citep{Hartley2003} like in \citep{Song2016}. \citet{Kneip2014opengv} introduce \texttt{OpenGV} library, a modern \texttt{C++} tool to compute relative and absolute pose with various algorithms.

Depending on the available data, heavier processing can be applied to refine the query pose. Bundle adjustment is the widely used technique when dealing with 3D structures or point cloud obtained from images. Works from~\citep{Middelberg2014,Wan2014,Forstner2016} apply bundle adjustment to refine the first guess pose from their method. Local bundle adjustment are used when real-time performances are targeted \citep{Li2010,Qu2016}. Another famous refinement method is the Iterative Closest Points algorithm (ICP), used in \ac{vbl} context in~\citep{Russell2011,Baatz2012,Morago2016}. \citet{Pani2015Lmi} provide algorithms to obtain an optimal alignment between images and point cloud data, or between point cloud and 3D model~\citep{Pani2015Robust}.

An aerial localization of an \ac{uav} unmanned aerial vehicle (UAV) from down-looking camera images is presented in~\citep{Wan2016}. Authors estimate a fine pose by registering the embedded camera image on a satellite images. A coarse pose information is needed for reducing the search scope. This solution is also validated for \ac{vbl} on foreign planet of the solar system. Over works present \ac{vbl} for lunar rover in extremely challenging condition~\citep{Wan2014}. In order to perform a fine pose estimation under hard conditions (lunar panorama with few discriminative visual elements), the authors have to use a reliable prior pose of the robot given by IMU and wheel odometers.

\citet{Arth2015} introduce a method to estimate a fine pose of a mobile camera to initialize AR applications or SLAM systems. Given a coarse prior pose of the camera (obtained by GPS and compass embedded in a smart-phone), authors refine the global pose by matching extracted geometric features to buildings outlines. Similarly, \citet{Russell2011} investigate techniques to retrieve the pose of realistic painted or drawn piece of art according to recent photographies. Given a coarse pose prior, the query location is refined by establishing edges correspondences with the real model. \citet{Poglitsch2015} introduce a particle filter to perform localization. The particles are randomly generated over a 3D model from a coarse position information from a GPS sensor. Widely spread in robotic community, particle filters have also been used to refine a coarse pose of a mobile robot in known ground 3D space~\citep{Mason2011} or an aerial map~\citep{Christie2016,Brubaker2016}.

InLoc + Hierarchical loc
